{
  "Timestamp": "2025-10-25T17:22:22.0444951Z",
  "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
  "FileHash": "11A87CD66B52E58B9B250D2FF11EB5CF96BF843BE924ECC2E9DCD9EF60358191",
  "Result": {
    "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
    "Violations": [
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 87,
        "Code": "\"https://contoso.com/app\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Adding member to privileged Azure AD role detected. Requires approval and justification.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 11,
        "Code": "Add-AzureADDirectoryRoleMember -RoleObjectId \"GlobalAdministrator\" -RefObjectId $objectId",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Adding member to privileged Azure AD role detected. Requires approval and justification.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 18,
        "Code": "Add-AzureADDirectoryRoleMember -RoleObjectId \"CompanyAdministrator\" -RefObjectId $objectId",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Adding member to privileged Azure AD role detected. Requires approval and justification.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 21,
        "Code": "Add-MgDirectoryRoleMember -DirectoryRoleId \"UserAdministrator\" -BodyParameter @{ \"@odata.id\" = \"https://graph.microsoft.com/v1.0/users/$objectId\" }",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Adding member to privileged Azure AD role detected. Requires approval and justification.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 24,
        "Code": "Add-AzureADDirectoryRoleMember -RoleObjectId \"SecurityAdministrator\" -RefObjectId $objectId",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Modifying privileged user account detected. Ensure proper authorization.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 27,
        "Code": "Set-AzureADUser -ObjectId \"admin@contoso.com\" -Department \"IT Security\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Modifying privileged user account detected. Ensure proper authorization.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 30,
        "Code": "Set-AzureADUser -ObjectId \"globaladmin@contoso.com\" -AccountEnabled $true",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Modifying privileged user account detected. Ensure proper authorization.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 33,
        "Code": "Update-MgUser -UserId \"privilegeduser@contoso.com\" -CompanyName \"Contoso\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Modifying privileged user account detected. Ensure proper authorization.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 36,
        "Code": "Set-AzureADUser -ObjectId \"securityadmin@contoso.com\" -PasswordPolicies \"DisablePasswordExpiration\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Creating Azure AD application with resource access permissions. Review for excessive permissions.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 48,
        "Code": "New-AzureADApplication -DisplayName \"PrivilegedApp\" -RequiredResourceAccess $appPermissions",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Creating Azure AD application with resource access permissions. Review for excessive permissions.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 51,
        "Code": "New-AzureADApplication -DisplayName \"AppWithRoles\" -AppRoles @(@{DisplayName=\"Admin\"})",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Creating Azure AD application with resource access permissions. Review for excessive permissions.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 54,
        "Code": "New-MgApplication -DisplayName \"GraphApp\" -RequiredResourceAccess @(@{ResourceAppId=\"00000003-0000-0000-c000-000000000000\"})",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Bulk user deletion detected. Ensure proper confirmation and backup procedures.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 59,
        "Code": "Remove-AzureADUser -ObjectId $user.ObjectId",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Bulk user deletion detected. Ensure proper confirmation and backup procedures.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 65,
        "Code": "Remove-MgUser -UserId $userId",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Modifying Azure AD policy detected. Ensure compliance with security standards.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 74,
        "Code": "Set-AzureADPolicy -Id \"12345678-1234-1234-1234-123456789012\" -Definition @(\"PolicyDefinition\")",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      },
      {
        "Name": "AzureEntraIDPrivilegedOperations",
        "Message": "Modifying Azure AD policy detected. Ensure compliance with security standards.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 77,
        "Code": "Set-AzureADPolicy -Id \"PolicyId\" -DisplayName \"WeakPolicy\" -Type \"ConditionalAccessPolicy\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-entra-id-privileged-operations.ps1",
        "RuleId": "AzureEntraIDPrivilegedOperations",
        "Metadata": {}
      }
    ],
    "ParseErrors": [],
    "RulesExecuted": 52,
    "Timestamp": "2025-10-25T17:22:22.0437143+00:00"
  }
}
