{
  "Timestamp": "2025-10-25T17:22:32.5247428Z",
  "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
  "FileHash": "34C2360C6F2C7DD576047FE2432740752CF1822A9EF115ED515C07E77AC8226A",
  "Result": {
    "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
    "Violations": [
      {
        "Name": "CredentialExposure",
        "Message": "Plaintext password conversion detected. Use Read-Host -AsSecureString instead.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 24,
        "Code": "ConvertTo-SecureString \"password\" -AsPlainText -Force",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "CredentialExposure",
        "Metadata": {}
      },
      {
        "Name": "PowerShellVersionDowngrade",
        "Message": "PowerShell v2 downgrade detected - bypasses modern security features",
        "Description": null,
        "Severity": 4,
        "LineNumber": 20,
        "Code": "\"powershell.exe -version 2\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "PowerShellVersionDowngrade",
        "Metadata": {}
      },
      {
        "Name": "PrivilegedRegistryAccess",
        "Message": "HKEY_LOCAL_MACHINE registry access detected. Consider if privileges are necessary.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 36,
        "Code": "Get-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\PowerShell\\1\\PowerShellEngine\" -Name \"PowerShellVersion\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "PrivilegedRegistryAccess",
        "Metadata": {}
      },
      {
        "Name": "EnhancedPowerShell2Detection",
        "Message": "PowerShell 2.0 invocation string detected - bypasses modern security features",
        "Description": null,
        "Severity": 3,
        "LineNumber": 20,
        "Code": "\"powershell.exe -version 2\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "EnhancedPowerShell2Detection",
        "Metadata": {}
      },
      {
        "Name": "EnhancedPowerShell2Detection",
        "Message": "PowerShell ISE usage detected - may indicate PowerShell 2.0 environment",
        "Description": null,
        "Severity": 3,
        "LineNumber": 11,
        "Code": "powershell_ise.exe -file \"script.ps1\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "EnhancedPowerShell2Detection",
        "Metadata": {}
      },
      {
        "Name": "EnhancedPowerShell2Detection",
        "Message": "PowerShell ISE usage detected - may indicate PowerShell 2.0 environment",
        "Description": null,
        "Severity": 3,
        "LineNumber": 12,
        "Code": "powershell_ise -command \"Get-Date\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "EnhancedPowerShell2Detection",
        "Metadata": {}
      },
      {
        "Name": "EnhancedPowerShell2Detection",
        "Message": "CLR v2 runtime version 'v2.0.50727' detected — may indicate PowerShell v2 or .NET 2.0 usage; review for legacy compatibility and security implications.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 15,
        "Code": "\"v2.0.50727\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "EnhancedPowerShell2Detection",
        "Metadata": {}
      },
      {
        "Name": "EnhancedPowerShell2Detection",
        "Message": "System.Management.Automation v2 reference detected — may indicate PowerShell v2 or .NET 2.0 usage; review for legacy compatibility and security implications.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 16,
        "Code": "\"System.Management.Automation, Version=2.0.0.0\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "EnhancedPowerShell2Detection",
        "Metadata": {}
      },
      {
        "Name": "EnhancedPowerShell2Detection",
        "Message": ".NET 2.x reference detected — may indicate PowerShell v2 or .NET 2.0 usage; review for legacy compatibility and security implications.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 17,
        "Code": "\".NET Framework 2.0\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "EnhancedPowerShell2Detection",
        "Metadata": {}
      },
      {
        "Name": "EnhancedPowerShell2Detection",
        "Message": "WMI-based PowerShell execution detected - often used for PS 2.0 bypass",
        "Description": null,
        "Severity": 3,
        "LineNumber": 20,
        "Code": "Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList \"powershell.exe -version 2\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "EnhancedPowerShell2Detection",
        "Metadata": {}
      },
      {
        "Name": "EnhancedPowerShell2Detection",
        "Message": "Legacy cmdlet usage detected: Add-PSSnapin - common in PowerShell 2.0 environments",
        "Description": null,
        "Severity": 2,
        "LineNumber": 26,
        "Code": "Add-PSSnapin Microsoft.PowerShell.Core",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "EnhancedPowerShell2Detection",
        "Metadata": {}
      },
      {
        "Name": "DeprecatedCmdletUsage",
        "Message": "Using deprecated System.Net.WebClient. Use Invoke-RestMethod or Invoke-WebRequest instead.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 25,
        "Code": "New-Object System.Net.WebClient",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "DeprecatedCmdletUsage",
        "Metadata": {}
      },
      {
        "Name": "DeprecatedCmdletUsage",
        "Message": "Using deprecated System.Net.WebClient. Use Invoke-RestMethod or Invoke-WebRequest instead.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 40,
        "Code": "New-Object System.Net.WebClient",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "DeprecatedCmdletUsage",
        "Metadata": {}
      },
      {
        "Name": "DeprecatedCmdletUsage",
        "Message": "Using deprecated WMI cmdlet 'Get-WmiObject'. Use CIM cmdlet 'Get-CimObject' instead.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 21,
        "Code": "Get-WmiObject -Class Win32_Process",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "DeprecatedCmdletUsage",
        "Metadata": {}
      },
      {
        "Name": "DeprecatedCmdletUsage",
        "Message": "Using deprecated WMI cmdlet 'Invoke-WmiMethod'. Use CIM cmdlet 'Invoke-CimMethod' instead.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 20,
        "Code": "Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList \"powershell.exe -version 2\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/enhanced-powershell2-detection.ps1",
        "RuleId": "DeprecatedCmdletUsage",
        "Metadata": {}
      }
    ],
    "ParseErrors": [],
    "RulesExecuted": 52,
    "Timestamp": "2025-10-25T17:22:32.5244189+00:00"
  }
}
