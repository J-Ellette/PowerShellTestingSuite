{
  "Timestamp": "2025-10-25T17:22:23.6604881Z",
  "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
  "FileHash": "EDDBF43403D977B555596DC1F121252E2523FF9B8B35E9D362BA1E86623F1009",
  "Result": {
    "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
    "Violations": [
      {
        "Name": "AzureResourceExposure",
        "Message": "Azure Storage Container set to public access: Blob",
        "Description": null,
        "Severity": 3,
        "LineNumber": 12,
        "Code": "New-AzStorageContainer -Name \"public-data\" -Context $ctx -Permission Blob",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      },
      {
        "Name": "AzureResourceExposure",
        "Message": "Azure Storage Container set to public access: Container",
        "Description": null,
        "Severity": 3,
        "LineNumber": 15,
        "Code": "Set-AzStorageContainerAcl -Container \"sensitive-data\" -Permission Container -Context $ctx",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      },
      {
        "Name": "AzureResourceExposure",
        "Message": "Azure SQL firewall rule allows access from all IPs (0.0.0.0)",
        "Description": null,
        "Severity": 4,
        "LineNumber": 18,
        "Code": "New-AzSqlServerFirewallRule -ResourceGroupName \"test-rg\" -ServerName \"testserver\" -FirewallRuleName \"AllowAll\" -StartIpAddress \"0.0.0.0\" -EndIpAddress \"255.255.255.255\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      },
      {
        "Name": "AzureResourceExposure",
        "Message": "Azure SQL firewall rule allows access from all IPs (0.0.0.0)",
        "Description": null,
        "Severity": 4,
        "LineNumber": 21,
        "Code": "New-AzSqlServerFirewallRule -ResourceGroupName \"prod-rg\" -ServerName \"prodserver\" -FirewallRuleName \"OpenAccess\" -StartIpAddress \"0.0.0.0\" -EndIpAddress \"0.0.0.0\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      },
      {
        "Name": "AzureResourceExposure",
        "Message": "NSG rule allows inbound traffic from any source (*)",
        "Description": null,
        "Severity": 3,
        "LineNumber": 25,
        "Code": "Add-AzNetworkSecurityRuleConfig -NetworkSecurityGroup $nsg -Name \"Allow-All-Inbound\" -Description \"Temporary rule\" -Access Allow -Protocol Tcp -Direction Inbound -Priority 100 -SourceAddressPrefix * -SourcePortRange * -DestinationAddressPrefix * -DestinationPortRange 80",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      },
      {
        "Name": "AzureResourceExposure",
        "Message": "NSG rule allows inbound traffic from any source (*)",
        "Description": null,
        "Severity": 3,
        "LineNumber": 28,
        "Code": "Add-AzNetworkSecurityRuleConfig -NetworkSecurityGroup $nsg -Name \"Allow-Internet\" -Access Allow -Protocol Tcp -Direction Inbound -Priority 110 -SourceAddressPrefix Internet -SourcePortRange * -DestinationAddressPrefix * -DestinationPortRange 443",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      },
      {
        "Name": "AzureResourceExposure",
        "Message": "NSG rule allows inbound traffic from any source (*)",
        "Description": null,
        "Severity": 3,
        "LineNumber": 31,
        "Code": "Add-AzNetworkSecurityRuleConfig -NetworkSecurityGroup $nsg -Name \"Allow-Any-CIDR\" -Access Allow -Protocol Tcp -Direction Inbound -Priority 120 -SourceAddressPrefix \"0.0.0.0/0\" -SourcePortRange * -DestinationAddressPrefix * -DestinationPortRange 22",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      },
      {
        "Name": "AzureResourceExposure",
        "Message": "Public IP address creation detected. Ensure this is necessary and properly secured.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 34,
        "Code": "New-AzPublicIpAddress -ResourceGroupName \"prod-rg\" -Name \"prod-web-ip\" -Location \"East US\" -AllocationMethod Static -Sku Standard",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      },
      {
        "Name": "AzureResourceExposure",
        "Message": "Public IP address creation detected. Ensure this is necessary and properly secured.",
        "Description": null,
        "Severity": 2,
        "LineNumber": 57,
        "Code": "New-AzPublicIpAddress -ResourceGroupName \"dev-rg\" -Name \"dev-test-ip\" -Location \"East US\" -AllocationMethod Dynamic",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      },
      {
        "Name": "AzureResourceExposure",
        "Message": "Key Vault access policy grants excessive permissions",
        "Description": null,
        "Severity": 2,
        "LineNumber": 37,
        "Code": "Set-AzKeyVaultAccessPolicy -VaultName \"test-keyvault\" -ObjectId \"12345678-1234-1234-1234-123456789012\" -PermissionsToSecrets all",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      },
      {
        "Name": "AzureResourceExposure",
        "Message": "Key Vault access policy grants excessive permissions",
        "Description": null,
        "Severity": 2,
        "LineNumber": 40,
        "Code": "Set-AzKeyVaultAccessPolicy -VaultName \"prod-vault\" -ObjectId \"87654321-4321-4321-4321-210987654321\" -PermissionsToKeys \"all\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      },
      {
        "Name": "AzureResourceExposure",
        "Message": "Key Vault access policy grants excessive permissions",
        "Description": null,
        "Severity": 2,
        "LineNumber": 43,
        "Code": "Set-AzKeyVaultAccessPolicy -VaultName \"shared-vault\" -ObjectId \"11111111-2222-3333-4444-555555555555\" -PermissionsToSecrets \"*\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      },
      {
        "Name": "AzureResourceExposure",
        "Message": "Key Vault access policy grants excessive permissions",
        "Description": null,
        "Severity": 2,
        "LineNumber": 60,
        "Code": "Set-AzKeyVaultAccessPolicy -VaultName \"secure-vault\" -ObjectId \"99999999-8888-7777-6666-555555555555\" -PermissionsToSecrets @(\"Get\", \"List\") -PermissionsToKeys @(\"Get\")",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-resource-exposure.ps1",
        "RuleId": "AzureResourceExposure",
        "Metadata": {}
      }
    ],
    "ParseErrors": [],
    "RulesExecuted": 52,
    "Timestamp": "2025-10-25T17:22:23.6597545+00:00"
  }
}
