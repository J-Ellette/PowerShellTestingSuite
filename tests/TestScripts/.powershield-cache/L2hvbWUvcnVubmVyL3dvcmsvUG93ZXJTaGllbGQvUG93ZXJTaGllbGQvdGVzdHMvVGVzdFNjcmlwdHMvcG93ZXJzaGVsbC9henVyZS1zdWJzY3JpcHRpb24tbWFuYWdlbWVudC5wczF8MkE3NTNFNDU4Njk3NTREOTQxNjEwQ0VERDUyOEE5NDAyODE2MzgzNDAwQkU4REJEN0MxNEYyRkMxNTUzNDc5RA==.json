{
  "Timestamp": "2025-10-25T17:22:23.9548850Z",
  "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
  "FileHash": "2A753E45869754D941610CEDD528A9402816383400BE8DBD7C14F2FC1553479D",
  "Result": {
    "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
    "Violations": [
      {
        "Name": "AzureSubscriptionManagement",
        "Message": "Switching to production subscription detected. Ensure proper authorization.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 10,
        "Code": "Set-AzContext -SubscriptionId \"12345678-1234-1234-1234-123456789012\" -SubscriptionName \"Production\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
        "RuleId": "AzureSubscriptionManagement",
        "Metadata": {}
      },
      {
        "Name": "AzureSubscriptionManagement",
        "Message": "Switching to production subscription detected. Ensure proper authorization.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 13,
        "Code": "Set-AzContext -Subscription \"Prod-Subscription\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
        "RuleId": "AzureSubscriptionManagement",
        "Metadata": {}
      },
      {
        "Name": "AzureSubscriptionManagement",
        "Message": "Switching to production subscription detected. Ensure proper authorization.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 16,
        "Code": "Set-AzContext -SubscriptionName \"Company-Production-001\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
        "RuleId": "AzureSubscriptionManagement",
        "Metadata": {}
      },
      {
        "Name": "AzureSubscriptionManagement",
        "Message": "Creating role definition with wildcard permissions (*). Use least privilege principle.",
        "Description": null,
        "Severity": 4,
        "LineNumber": 36,
        "Code": "New-AzRoleDefinition -Name \"WildcardRole\" -Description \"Too broad\" -Actions @(\"Microsoft.Compute/*\", \"Microsoft.Storage/*\") -AssignableScopes \"/\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
        "RuleId": "AzureSubscriptionManagement",
        "Metadata": {}
      },
      {
        "Name": "AzureSubscriptionManagement",
        "Message": "Bulk role assignment removal detected. Verify authorization and backup.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 41,
        "Code": "Remove-AzRoleAssignment -ObjectId $assignment.ObjectId -RoleDefinitionName $assignment.RoleDefinitionName -Scope $assignment.Scope",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
        "RuleId": "AzureSubscriptionManagement",
        "Metadata": {}
      },
      {
        "Name": "AzureSubscriptionManagement",
        "Message": "Bulk role assignment removal detected. Verify authorization and backup.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 52,
        "Code": "Remove-AzRoleAssignment -ObjectId $user.ObjectId -RoleDefinitionName \"Contributor\" -Scope $user.Scope",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
        "RuleId": "AzureSubscriptionManagement",
        "Metadata": {}
      },
      {
        "Name": "AzureSubscriptionManagement",
        "Message": "Modifying subscription settings detected. Ensure change management approval.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 56,
        "Code": "Set-AzSubscription -SubscriptionId \"sub-id\" -TenantId \"tenant-id\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
        "RuleId": "AzureSubscriptionManagement",
        "Metadata": {}
      },
      {
        "Name": "AzureSubscriptionManagement",
        "Message": "Modifying subscription settings detected. Ensure change management approval.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 59,
        "Code": "Set-AzSubscription -Name \"Production\" -MaxVMCount 1000",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
        "RuleId": "AzureSubscriptionManagement",
        "Metadata": {}
      },
      {
        "Name": "AzureSubscriptionManagement",
        "Message": "Cross-subscription resource move detected. Verify security implications.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 62,
        "Code": "Move-AzResource -ResourceId \"/subscriptions/source-sub/resourceGroups/rg/providers/Microsoft.Storage/storageAccounts/storage1\" -DestinationSubscriptionId \"dest-sub-id\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
        "RuleId": "AzureSubscriptionManagement",
        "Metadata": {}
      },
      {
        "Name": "AzureSubscriptionManagement",
        "Message": "Cross-subscription resource move detected. Verify security implications.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 66,
        "Code": "Move-AzResource -ResourceId $vmId -DestinationSubscriptionId \"sub2\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
        "RuleId": "AzureSubscriptionManagement",
        "Metadata": {}
      },
      {
        "Name": "AzureSubscriptionManagement",
        "Message": "Cross-subscription resource move detected. Verify security implications.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 69,
        "Code": "Move-AzResource -ResourceId \"/subscriptions/sub1/resourceGroups/rg/providers/Microsoft.Sql/servers/sql1/databases/db1\" -DestinationSubscriptionId \"sub2\" -DestinationResourceGroupName \"rg2\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
        "RuleId": "AzureSubscriptionManagement",
        "Metadata": {}
      },
      {
        "Name": "AzureSubscriptionManagement",
        "Message": "Cross-subscription resource move detected. Verify security implications.",
        "Description": null,
        "Severity": 3,
        "LineNumber": 77,
        "Code": "Move-AzResource -ResourceId $resourceId -DestinationSubscriptionId \"sub2\"",
        "FilePath": "/home/runner/work/PowerShield/PowerShield/tests/TestScripts/powershell/azure-subscription-management.ps1",
        "RuleId": "AzureSubscriptionManagement",
        "Metadata": {}
      }
    ],
    "ParseErrors": [],
    "RulesExecuted": 52,
    "Timestamp": "2025-10-25T17:22:23.9543853+00:00"
  }
}
